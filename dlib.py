def bh_calc(r_km,ele):
    import numpy as np
    a=6.371e3; ae=4/3*a;
    bh=(r_km**2+ae**2+2*r_km*ae*np.sin(ele))**(1/2)-ae;
    return bh

def dewpointDepression(temperature,dewpoint):
    dewpoint_depression = temperature - dewpoint
    return dewpoint_depression

def NWS_ref_cmap():
    from matplotlib.colors import LinearSegmentedColormap
    _NWSRef_data = {
        "blue": [
            (0.0, 0.92549019607843142, 0.92549019607843142),
            (0.07142857, 0.96470588235294119, 0.96470588235294119),
            (0.14285714, 0.96470588235294119, 0.96470588235294119),
            (0.21428571, 0.0, 0.0),
            (0.28571429, 0.0, 0.0),
            (0.35714286, 0.0, 0.0),
            (0.42857143, 0.0, 0.0),
            (0.50000000, 0.0, 0.0),
            (0.57142857, 0.0, 0.0),
            (0.64285714, 0.0, 0.0),
            (0.71428571, 0.0, 0.0),
            (0.78571429, 0.0, 0.0),
            (0.85714286, 1.0, 1.0),
            (0.92857143, 0.78823529411764703, 0.78823529411764703),
            (1.0, 0.0, 0.0),
        ],
        "green": [
            (0.0, 0.92549019607843142, 0.92549019607843142),
            (0.07142857, 0.62745098039215685, 0.62745098039215685),
            (0.14285714, 0.0, 0.0),
            (0.21428571, 1.0, 1.0),
            (0.28571429, 0.78431372549019607, 0.78431372549019607),
            (0.35714286, 0.56470588235294117, 0.56470588235294117),
            (0.42857143, 1.0, 1.0),
            (0.50000000, 0.75294117647058822, 0.75294117647058822),
            (0.57142857, 0.56470588235294117, 0.56470588235294117),
            (0.64285714, 0.0, 0.0),
            (0.71428571, 0.0, 0.0),
            (0.78571429, 0.0, 0.0),
            (0.85714286, 0.0, 0.0),
            (0.92857143, 0.33333333333333331, 0.33333333333333331),
            (1.0, 0.0, 0.0),
        ],
        "red": [
            (0.0, 0.0, 0.0),
            (0.07142857, 0.0039215686274509803, 0.0039215686274509803),
            (0.14285714, 0.0, 0.0),
            (0.21428571, 0.0, 0.0),
            (0.28571429, 0.0, 0.0),
            (0.35714286, 0.0, 0.0),
            (0.42857143, 1.0, 1.0),
            (0.50000000, 0.90588235294117647, 0.90588235294117647),
            (0.57142857, 1.0, 1.0),
            (0.64285714, 1.0, 1.0),
            (0.71428571, 0.83921568627450982, 0.83921568627450982),
            (0.78571429, 0.75294117647058822, 0.75294117647058822),
            (0.85714286, 1.0, 1.0),
            (0.92857143, 0.59999999999999998, 0.59999999999999998),
            (1.0, 0.0, 0.0),
        ],
    }

    cmap_ref = LinearSegmentedColormap('nwsref',_NWSRef_data)

    return cmap_ref

def NWS_vel_cmap():
    from matplotlib.colors import LinearSegmentedColormap
    _NWSVel_data = {
        "blue": [
            (0.0, 0.62352941176470589, 0.62352941176470589),
            (0.071428571428571425, 0.0, 0.0),
            (0.14285714285714285, 0.0, 0.0),
            (0.21428571428571427, 0.0, 0.0),
            (0.2857142857142857, 0.0, 0.0),
            (0.3571428571428571, 0.0, 0.0),
            (0.42857142857142855, 0.0, 0.0),
            (0.5, 0.46666666666666667, 0.46666666666666667),
            (0.5714285714285714, 0.46666666666666667, 0.46666666666666667),
            (0.64285714285714279, 0.0, 0.0),
            (0.71428571428571419, 0.0, 0.0),
            (0.7857142857142857, 0.0, 0.0),
            (0.8571428571428571, 0.0, 0.0),
            (0.92857142857142849, 0.0, 0.0),
            (1.0, 0.0, 0.0),
        ],
        "green": [
            (0.0, 0.0, 0.0),
            (0.071428571428571425, 1.0, 1.0),
            (0.14285714285714285, 0.90980392156862744, 0.90980392156862744),
            (0.21428571428571427, 0.78431372549019607, 0.78431372549019607),
            (0.2857142857142857, 0.69019607843137254, 0.69019607843137254),
            (0.3571428571428571, 0.56470588235294117, 0.56470588235294117),
            (0.42857142857142855, 0.4392156862745098, 0.4392156862745098),
            (0.5, 0.59215686274509804, 0.59215686274509804),
            (0.5714285714285714, 0.46666666666666667, 0.46666666666666667),
            (0.64285714285714279, 0.0, 0.0),
            (0.71428571428571419, 0.0, 0.0),
            (0.7857142857142857, 0.0, 0.0),
            (0.8571428571428571, 0.0, 0.0),
            (0.92857142857142849, 0.0, 0.0),
            (1.0, 0.0, 0.0),
        ],
        "red": [
            (0.0, 0.56470588235294117, 0.56470588235294117),
            (0.071428571428571425, 0.0, 0.0),
            (0.14285714285714285, 0.0, 0.0),
            (0.21428571428571427, 0.0, 0.0),
            (0.2857142857142857, 0.0, 0.0),
            (0.3571428571428571, 0.0, 0.0),
            (0.42857142857142855, 0.0, 0.0),
            (0.5, 0.46666666666666667, 0.46666666666666667),
            (0.5714285714285714, 0.59215686274509804, 0.59215686274509804),
            (0.64285714285714279, 0.50196078431372548, 0.50196078431372548),
            (0.71428571428571419, 0.62745098039215685, 0.62745098039215685),
            (0.7857142857142857, 0.72156862745098038, 0.72156862745098038),
            (0.8571428571428571, 0.84705882352941175, 0.84705882352941175),
            (0.92857142857142849, 0.93333333333333335, 0.93333333333333335),
            (1.0, 1.0, 1.0),
        ],
    }

    cmap_vel = LinearSegmentedColormap('nwsvel',_NWSVel_data)

    return cmap_vel

def carbone42():
    from matplotlib.colors import LinearSegmentedColormap
    _Carbone42_data = {
        "blue": [
            (0.0, 0.63921568627450975, 0.63921568627450975),
            (0.024390243902439025, 0.55686274509803924, 0.55686274509803924),
            (0.04878048780487805, 0.58039215686274515, 0.58039215686274515),
            (0.073170731707317083, 0.6705882352941176, 0.6705882352941176),
            (0.097560975609756101, 0.76470588235294112, 0.76470588235294112),
            (0.12195121951219512, 0.89411764705882357, 0.89411764705882357),
            (0.14634146341463417, 0.99215686274509807, 0.99215686274509807),
            (0.17073170731707318, 0.99215686274509807, 0.99215686274509807),
            (0.1951219512195122, 0.59999999999999998, 0.59999999999999998),
            (0.21951219512195122, 0.36862745098039218, 0.36862745098039218),
            (0.24390243902439024, 0.0, 0.0),
            (0.26829268292682928, 0.0, 0.0),
            (0.29268292682926833, 0.0, 0.0),
            (0.31707317073170732, 0.058823529411764705, 0.058823529411764705),
            (0.34146341463414637, 0.17254901960784313, 0.17254901960784313),
            (0.36585365853658536, 0.28627450980392155, 0.28627450980392155),
            (0.3902439024390244, 0.40000000000000002, 0.40000000000000002),
            (0.41463414634146345, 0.51764705882352946, 0.51764705882352946),
            (0.43902439024390244, 0.63137254901960782, 0.63137254901960782),
            (0.46341463414634149, 0.74901960784313726, 0.74901960784313726),
            (0.48780487804878048, 0.81568627450980391, 0.81568627450980391),
            (0.51219512195121952, 0.69019607843137254, 0.69019607843137254),
            (0.53658536585365857, 0.34901960784313724, 0.34901960784313724),
            (0.56097560975609762, 0.0, 0.0),
            (0.58536585365853666, 0.019607843137254902, 0.019607843137254902),
            (0.6097560975609756, 0.054901960784313725, 0.054901960784313725),
            (0.63414634146341464, 0.082352941176470587, 0.082352941176470587),
            (0.65853658536585369, 0.11372549019607843, 0.11372549019607843),
            (0.68292682926829273, 0.14509803921568629, 0.14509803921568629),
            (0.70731707317073178, 0.17647058823529413, 0.17647058823529413),
            (0.73170731707317072, 0.20784313725490197, 0.20784313725490197),
            (0.75609756097560976, 0.23921568627450981, 0.23921568627450981),
            (0.78048780487804881, 0.24705882352941178, 0.24705882352941178),
            (0.80487804878048785, 0.24705882352941178, 0.24705882352941178),
            (0.8292682926829269, 0.29411764705882354, 0.29411764705882354),
            (0.85365853658536583, 0.37254901960784315, 0.37254901960784315),
            (0.87804878048780488, 0.0, 0.0),
            (0.90243902439024393, 0.18431372549019609, 0.18431372549019609),
            (0.92682926829268297, 0.27058823529411763, 0.27058823529411763),
            (0.95121951219512202, 0.35294117647058826, 0.35294117647058826),
            (0.97560975609756095, 0.35294117647058826, 0.35294117647058826),
            (1.0, 0.0, 0.0),
        ],
        "green": [
            (0.0, 0.019607843137254902, 0.019607843137254902),
            (0.024390243902439025, 0.22352941176470589, 0.22352941176470589),
            (0.04878048780487805, 0.054901960784313725, 0.054901960784313725),
            (0.073170731707317083, 0.054901960784313725, 0.054901960784313725),
            (0.097560975609756101, 0.054901960784313725, 0.054901960784313725),
            (0.12195121951219512, 0.13725490196078433, 0.13725490196078433),
            (0.14634146341463417, 0.37254901960784315, 0.37254901960784315),
            (0.17073170731707318, 0.55686274509803924, 0.55686274509803924),
            (0.1951219512195122, 0.58823529411764708, 0.58823529411764708),
            (0.21951219512195122, 0.52156862745098043, 0.52156862745098043),
            (0.24390243902439024, 0.44313725490196076, 0.44313725490196076),
            (0.26829268292682928, 0.49019607843137253, 0.49019607843137253),
            (0.29268292682926833, 0.53725490196078429, 0.53725490196078429),
            (0.31707317073170732, 0.58431372549019611, 0.58431372549019611),
            (0.34146341463414637, 0.63137254901960782, 0.63137254901960782),
            (0.36585365853658536, 0.67843137254901964, 0.67843137254901964),
            (0.3902439024390244, 0.72156862745098038, 0.72156862745098038),
            (0.41463414634146345, 0.7686274509803922, 0.7686274509803922),
            (0.43902439024390244, 0.81568627450980391, 0.81568627450980391),
            (0.46341463414634149, 0.86274509803921573, 0.86274509803921573),
            (0.48780487804878048, 0.8901960784313725, 0.8901960784313725),
            (0.51219512195121952, 0.8901960784313725, 0.8901960784313725),
            (0.53658536585365857, 0.85882352941176465, 0.85882352941176465),
            (0.56097560975609762, 0.81176470588235294, 0.81176470588235294),
            (0.58536585365853666, 0.76470588235294112, 0.76470588235294112),
            (0.6097560975609756, 0.71764705882352942, 0.71764705882352942),
            (0.63414634146341464, 0.6705882352941176, 0.6705882352941176),
            (0.65853658536585369, 0.62352941176470589, 0.62352941176470589),
            (0.68292682926829273, 0.57647058823529407, 0.57647058823529407),
            (0.70731707317073178, 0.52941176470588236, 0.52941176470588236),
            (0.73170731707317072, 0.4823529411764706, 0.4823529411764706),
            (0.75609756097560976, 0.43529411764705883, 0.43529411764705883),
            (0.78048780487804881, 0.38823529411764707, 0.38823529411764707),
            (0.80487804878048785, 0.3411764705882353, 0.3411764705882353),
            (0.8292682926829269, 0.32549019607843138, 0.32549019607843138),
            (0.85365853658536583, 0.30980392156862746, 0.30980392156862746),
            (0.87804878048780488, 0.0, 0.0),
            (0.90243902439024393, 0.082352941176470587, 0.082352941176470587),
            (0.92682926829268297, 0.14509803921568629, 0.14509803921568629),
            (0.95121951219512202, 0.20784313725490197, 0.20784313725490197),
            (0.97560975609756095, 0.27058823529411763, 0.27058823529411763),
            (1.0, 0.011764705882352941, 0.011764705882352941),
        ],
        "red": [
            (0.0, 0.46666666666666667, 0.46666666666666667),
            (0.024390243902439025, 0.40000000000000002, 0.40000000000000002),
            (0.04878048780487805, 0.16078431372549021, 0.16078431372549021),
            (0.073170731707317083, 0.22352941176470589, 0.22352941176470589),
            (0.097560975609756101, 0.28627450980392155, 0.28627450980392155),
            (0.12195121951219512, 0.34901960784313724, 0.34901960784313724),
            (0.14634146341463417, 0.41176470588235292, 0.41176470588235292),
            (0.17073170731707318, 0.44313725490196076, 0.44313725490196076),
            (0.1951219512195122, 0.27843137254901962, 0.27843137254901962),
            (0.21951219512195122, 0.18431372549019609, 0.18431372549019609),
            (0.24390243902439024, 0.0039215686274509803, 0.0039215686274509803),
            (0.26829268292682928, 0.0, 0.0),
            (0.29268292682926833, 0.0, 0.0),
            (0.31707317073170732, 0.058823529411764705, 0.058823529411764705),
            (0.34146341463414637, 0.17254901960784313, 0.17254901960784313),
            (0.36585365853658536, 0.28627450980392155, 0.28627450980392155),
            (0.3902439024390244, 0.40000000000000002, 0.40000000000000002),
            (0.41463414634146345, 0.51764705882352946, 0.51764705882352946),
            (0.43902439024390244, 0.63137254901960782, 0.63137254901960782),
            (0.46341463414634149, 0.74901960784313726, 0.74901960784313726),
            (0.48780487804878048, 0.81568627450980391, 0.81568627450980391),
            (0.51219512195121952, 0.92549019607843142, 0.92549019607843142),
            (0.53658536585365857, 0.93725490196078431, 0.93725490196078431),
            (0.56097560975609762, 0.93725490196078431, 0.93725490196078431),
            (0.58536585365853666, 0.93725490196078431, 0.93725490196078431),
            (0.6097560975609756, 0.93725490196078431, 0.93725490196078431),
            (0.63414634146341464, 0.92549019607843142, 0.92549019607843142),
            (0.65853658536585369, 0.87058823529411766, 0.87058823529411766),
            (0.68292682926829273, 0.81568627450980391, 0.81568627450980391),
            (0.70731707317073178, 0.75686274509803919, 0.75686274509803919),
            (0.73170731707317072, 0.70196078431372544, 0.70196078431372544),
            (0.75609756097560976, 0.6470588235294118, 0.6470588235294118),
            (0.78048780487804881, 0.58823529411764708, 0.58823529411764708),
            (0.80487804878048785, 0.53333333333333333, 0.53333333333333333),
            (0.8292682926829269, 0.4823529411764706, 0.4823529411764706),
            (0.85365853658536583, 0.62745098039215685, 0.62745098039215685),
            (0.87804878048780488, 0.62352941176470589, 0.62352941176470589),
            (0.90243902439024393, 0.71764705882352942, 0.71764705882352942),
            (0.92682926829268297, 0.81176470588235294, 0.81176470588235294),
            (0.95121951219512202, 0.8784313725490196, 0.8784313725490196),
            (0.97560975609756095, 0.94509803921568625, 0.94509803921568625),
            (1.0, 1.0, 1.0),
        ],
    }

    
    cmap_carb42 = LinearSegmentedColormap('carbone42',_Carbone42_data)

    return cmap_carb42
    
